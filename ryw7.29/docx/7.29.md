###7.29日报
>大数据-电商数仓-05-商品主题连带分析看板
> ADS层表设计、原始数据分析、关键指标
> 分析目标
识别连带商品：分析“引流品”、“热销品”与其他商品是否存在访问、加购、支付等行为上的“无序关联”。

优化商品布局：借助引导力强的商品，提升其他商品的曝光和转化。

支持业务决策：为详情页设计、关联营销推荐、搭配促销提供数据支持。

二、ADS层表设计
表1：ads_item_lian_dai_relation_1d（商品连带关系表）
字段名	类型	描述
dt	STRING	日期
main_item_id	STRING	主商品ID（引流品或热销品）
rel_item_id	STRING	被连带的商品ID
relation_type	STRING	关联类型（visit、cart、pay）
same_user_cnt	BIGINT	同时发生行为的用户数
same_session_cnt	BIGINT	同会话行为次数
rank	INT	连带商品在主商品下的排名
relation_score	DOUBLE	连带关联评分（可按访问+加购+支付加权）

表2：ads_item_lian_dai_effect_1d（商品引导转化效果表）
字段名	类型	描述
dt	STRING	日期
item_id	STRING	被监控的主商品ID
guide_pv	BIGINT	主商品详情页访问量
guide_uv	BIGINT	主商品引导其他商品的访客数
guide_cart_uv	BIGINT	由主商品引导后加购的用户数
guide_pay_uv	BIGINT	由主商品引导后支付的用户数
guide_item_cnt	BIGINT	被引导商品数量
guide_item_detail	STRING	被引导商品明细（json格式存top3）

三、原始数据分析
1. 用户行为日志表（明细表）
   如 dwd_traffic_log_detail，字段包括：

user_id

session_id

page_id

item_id

event_type（pv、cart、pay）

event_time

2. 商品属性维度
   如 dim_sku_full：

sku_id

item_name

is_drainage（是否引流品）

is_hot（是否热销品）

四、关键指标与实现思路
1. 识别“引流品”、“热销品”
   在 dws_sku_visit_1d 中找出近7天：

访问UV最高的TOP N => 引流品

支付订单数最多的TOP N => 热销品

sql
复制
编辑
-- 引流品TOP10
SELECT item_id, SUM(pv_uv) AS total_uv
FROM dws_sku_visit_1d
WHERE dt >= date_sub(current_date, 7)
GROUP BY item_id
ORDER BY total_uv DESC
LIMIT 10;